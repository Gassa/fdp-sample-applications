# FDP Sample Application for Integration with Analytics Pipeline

The application uses the distributed master/worker pattern and is implemented using Akka clustering.

To run the application, the recommended way is to run the processes in separate JVMs. The application consists of the following components that can be run together ina single JVM or separate JVMs:

* Workers - they are not part of the cluster but can be used to distribute work by the front end
* Front End - generates work and sends to the master / backend
* Backend / Master - Takes work from front end and distributes amongst workers 

## Steps to run the application

* Start backend (`2551` is a seed node for the cluster)

`$ sbt "runMain com.lightbend.fdp.sample.Main 2551"`

* Start another backend (`2552` is a seed node for the cluster)

`$ sbt "runMain com.lightbend.fdp.sample.Main 2552"`

* Start frontend (Port numbers should be between `3000` and `3999`)

`$ sbt "runMain com.lightbend.fdp.sample.Main 3001"`

* Start worker (Start instances of workers to to perform the job)

`$ sbt "runMain com.lightbend.fdp.sample.Main 0"`

## Control Points and Scaling Action

The workers execute a job which is computing the sum of the factorials of the elements of a randomly generated list of integers. The job is generated by the *frontend* process and has 2 *control points* to increase the load on the system:

```
akka {
  job {
    max-list-size = ...
    max-list-element-value = ...
  }
}
```

The default values are there in `application.conf`. The defaults can be overridden by using `-Dname=value` pattern just as in other Akka applications. e.g. to submit jobs that generate lists of max length `200` containing a max value of `2000`, you need to start the *frontend* process as follows:

```
$ sbt -Dakka.job.max-list-size=200 -Dakka.job.max-list-element-value=2000 "runMain com.lightbend.fdp.sample.Main 3001"
```

The way to increase the load on the system is to submit more CPU intensive jobs. This can be done by changing the control points during startup of the front end process.

The system generates statistics on the number of jobs completed within the last 1 minute. This can be considered the response of the system. In order to improve the response when it falls below some threshold, more workers can be started. This is the *scaling action*. Just open a terminal window and start separate processes for more workers:

```
$ sbt "runMain com.lightbend.fdp.sample.Main 0"
$ sbt "runMain com.lightbend.fdp.sample.Main 0"
```


